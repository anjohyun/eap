<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>정신건강 종합 문진</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 60px 24px 40px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.05); opacity: 0.1; }
        }

        .header h1 {
            font-size: 28px;
            font-weight: 300;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .header .subtitle {
            font-size: 16px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        /* 시작 화면 스타일 */
        .intro-section {
            padding: 32px 24px;
            text-align: center;
        }

        .intro-title {
            font-size: 24px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 16px;
        }

        .intro-description {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .test-info {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            text-align: left;
        }

        .test-item {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            padding: 16px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .test-item:last-child {
            margin-bottom: 0;
        }

        .test-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            margin-right: 16px;
        }

        .test-icon.phq9 { background: #10b981; }
        .test-icon.gad7 { background: #f59e0b; }
        .test-icon.koss { background: #8b5cf6; }

        .test-content h3 {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .test-content p {
            font-size: 14px;
            color: #6b7280;
        }

        /* 문진 화면 스타일 */
        .assessment-section {
            display: none;
            padding: 24px;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .question-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .question-header {
            margin-bottom: 24px;
        }

        .test-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            margin-bottom: 12px;
        }

        .question-number {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            color: #1f2937;
            line-height: 1.4;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            background: #e3f2fd;
            border-color: #bbdefb;
        }

        .option.selected {
            background: #e3f2fd;
            border-color: #2196f3;
        }

        .option-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            margin-right: 12px;
            position: relative;
            transition: all 0.2s;
        }

        .option.selected .option-radio {
            border-color: #2196f3;
        }

        .option.selected .option-radio::after {
            content: '';
            width: 10px;
            height: 10px;
            background: #2196f3;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .option-text {
            flex: 1;
            font-size: 16px;
            color: #374151;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 24px;
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            min-width: 120px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #d1d5db;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6b7280;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        /* 결과 화면 스타일 */
        .results-section {
            display: none;
        }

        .status-overview {
            display: flex;
            justify-content: space-around;
            padding: 24px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .status-card {
            text-align: center;
            flex: 1;
            padding: 16px 8px;
            background: white;
            border-radius: 16px;
            margin: 0 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .status-card:hover {
            transform: translateY(-2px);
        }

        .status-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        .status-normal { background: #10b981; }
        .status-mild { background: #f59e0b; }
        .status-moderate { background: #ef4444; }
        .status-severe { background: #dc2626; }

        .status-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .status-value {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }

        .content {
            padding: 24px;
        }

        .section {
            margin-bottom: 32px;
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1f2937;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            border-radius: 2px;
            margin-right: 12px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-size: 16px;
            color: #374151;
            flex: 1;
        }

        .result-score {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-right: 12px;
        }

        .result-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            color: white;
        }

        .stress-factors {
            margin-top: 24px;
        }

        .stress-factor-item {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #fef3c7;
            border-radius: 12px;
            margin-bottom: 12px;
            border-left: 4px solid #f59e0b;
        }

        .stress-factor-rank {
            width: 32px;
            height: 32px;
            background: #f59e0b;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 16px;
            font-size: 14px;
        }

        .stress-factor-content {
            flex: 1;
        }

        .stress-factor-title {
            font-size: 16px;
            font-weight: 600;
            color: #92400e;
            margin-bottom: 4px;
        }

        .stress-factor-desc {
            font-size: 14px;
            color: #a16207;
            line-height: 1.4;
        }

        .recommendation {
            background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%);
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
        }

        .recommendation h3 {
            color: #0277bd;
            margin-bottom: 16px;
            font-size: 18px;
        }

        .recommendation-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .recommendation-item::before {
            content: '✓';
            color: #0277bd;
            font-weight: bold;
            margin-right: 12px;
            margin-top: 2px;
        }

        .recommendation-item:last-child {
            margin-bottom: 0;
        }

        .alert {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .timestamp {
            text-align: center;
            color: #6b7280;
            font-size: 14px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 시작 화면 -->
        <div id="intro-screen">
            <div class="header">
                <h1>정신건강 종합 문진</h1>
                <p class="subtitle">나의 마음 상태를 확인해보세요</p>
            </div>

            <div class="intro-section">
                <h2 class="intro-title">정신건강 상태 종합 검사</h2>
                <p class="intro-description">
                    우울, 불안, 직무스트레스 수준을 종합적으로 평가하여<br>
                    맞춤형 관리 방안을 제시합니다.
                </p>

                <div class="test-info">
                    <div class="test-item">
                        <div class="test-icon phq9">🧠</div>
                        <div class="test-content">
                            <h3>PHQ-9 우울증 선별검사</h3>
                            <p>9개 문항 · 약 2분 소요</p>
                        </div>
                    </div>
                    <div class="test-item">
                        <div class="test-icon gad7">💭</div>
                        <div class="test-content">
                            <h3>GAD-7 불안장애 선별검사</h3>
                            <p>7개 문항 · 약 2분 소요</p>
                        </div>
                    </div>
                    <div class="test-item">
                        <div class="test-icon koss">💼</div>
                        <div class="test-content">
                            <h3>KOSS 직무스트레스 측정</h3>
                            <p>26개 문항 · 약 5분 소요</p>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="startAssessment()">검사 시작하기</button>
            </div>
        </div>

        <!-- 문진 화면 -->
        <div id="assessment-screen" class="assessment-section">
            <div class="header">
                <h1 id="current-test-title">PHQ-9 우울증 선별검사</h1>
                <p class="subtitle" id="current-test-subtitle">지난 2주 동안의 경험을 떠올려 주세요</p>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="question-card">
                <div class="question-header">
                    <span class="test-badge" id="test-badge">PHQ-9</span>
                    <div class="question-number" id="question-number">질문 1 / 9</div>
                    <div class="question-text" id="question-text"></div>
                </div>

                <div class="options" id="options-container"></div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" id="prev-btn" onclick="previousQuestion()" disabled>이전</button>
                <button class="btn" id="next-btn" onclick="nextQuestion()" disabled>다음</button>
            </div>
        </div>

        <!-- 결과 화면 -->
        <div id="results-screen" class="results-section">
            <div class="header">
                <h1>종합 문진 결과</h1>
                <p class="subtitle">정신건강 상태 종합 분석</p>
            </div>

            <div class="status-overview">
                <div class="status-card">
                    <div class="status-icon" id="phq9-icon">0</div>
                    <div class="status-label">PHQ-9</div>
                    <div class="status-value" id="phq9-status">-</div>
                </div>
                <div class="status-card">
                    <div class="status-icon" id="gad7-icon">0</div>
                    <div class="status-label">GAD-7</div>
                    <div class="status-value" id="gad7-status">-</div>
                </div>
                <div class="status-card">
                    <div class="status-icon" id="koss-icon">0</div>
                    <div class="status-label">KOSS</div>
                    <div class="status-value" id="koss-status">-</div>
                </div>
            </div>

            <div class="content">
                <div class="section">
                    <div class="section-title">상세 검사 결과</div>
                    
                    <div class="result-item">
                        <div class="result-label">PHQ-9 (우울증 선별검사)</div>
                        <div class="result-score" id="phq9-score">0점</div>
                        <div class="result-status" id="phq9-result-status">정상</div>
                    </div>
                    
                    <div class="result-item">
                        <div class="result-label">GAD-7 (불안장애 선별검사)</div>
                        <div class="result-score" id="gad7-score">0점</div>
                        <div class="result-status" id="gad7-result-status">정상</div>
                    </div>
                    
                    <div class="result-item">
                        <div class="result-label">KOSS (직무스트레스 측정)</div>
                        <div class="result-score" id="koss-score">0점</div>
                        <div class="result-status" id="koss-result-status">정상</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">전문가 상세 분석</div>
                    
                    <div id="analysis-content">
                        <!-- 분석 내용이 동적으로 생성됩니다 -->
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">맞춤형 관리 방안</div>
                    
                    <div class="recommendation">
                        <h3>즉시 실행 가능한 관리법</h3>
                        <div id="immediate-recommendations">
                            <!-- 추천사항이 동적으로 생성됩니다 -->
                        </div>
                    </div>

                    <div class="recommendation">
                        <h3>전문적 도움</h3>
                        <div id="professional-recommendations">
                            <!-- 추천사항이 동적으로 생성됩니다 -->
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="restartAssessment()">다시 검사하기</button>
                
                <div class="timestamp" id="timestamp">
                    <!-- 타임스탬프가 동적으로 생성됩니다 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 검사 데이터
        const assessmentData = {
            phq9: {
                title: "PHQ-9 우울증 선별검사",
                subtitle: "지난 2주 동안의 경험을 떠올려 주세요",
                badge: "PHQ-9",
                questions: [
                    "일이나 다른 활동을 하는데 흥미나 즐거움을 거의 느끼지 못함",
                    "기분이 가라앉거나, 우울하거나, 희망이 없다고 느낌",
                    "잠들기 어렵거나 계속 잠을 자기 어려움, 또는 너무 많이 잠",
                    "피곤하다고 느끼거나 기력이 거의 없음",
                    "입맛이 없거나 과식을 함",
                    "자신을 부정적으로 봄 - 혹은 자신이 실패자라고 느끼거나 자신 또는 가족을 실망시켰다고 느낌",
                    "신문을 읽거나 텔레비전 보는 것과 같은 일에 집중하는 것이 어려움",
                    "다른 사람들이 주목할 정도로 평소보다 말이나 행동이 느려짐, 또는 반대로 안절부절 못하거나 들떠서 평소보다 많이 움직임",
                    "차라리 죽는 것이 더 낫겠다고 생각하거나 어떤 식으로든 자신을 해칠 것이라고 생각함"
                ],
                options: [
                    "전혀 그렇지 않다",
                    "며칠 동안 그랬다",
                    "7일 이상 그랬다",
                    "거의 매일 그랬다"
                ]
            },
            gad7: {
                title: "GAD-7 불안장애 선별검사",
                subtitle: "지난 2주 동안의 경험을 떠올려 주세요",
                badge: "GAD-7",
                questions: [
                    "초조하거나 불안하거나 조마조마하게 느낌",
                    "걱정하는 것을 멈추거나 조절할 수 없음",
                    "여러 가지 것들에 대해 걱정을 너무 많이 함",
                    "편하게 있기가 어려움",
                    "너무 안절부절못해서 가만히 있기가 힘듦",
                    "쉽게 짜증이 나거나 성을 내게 됨",
                    "마치 끔찍한 일이 일어날 것처럼 두려워함"
                ],
                options: [
                    "전혀 그렇지 않다",
                    "며칠 동안 그랬다",
                    "7일 이상 그랬다",
                    "거의 매일 그랬다"
                ]
            },
            koss: {
                title: "KOSS 직무스트레스 측정",
                subtitle: "현재 직장 상황에 대해 답변해 주세요",
                badge: "KOSS",
                questions: [
                    "물리적 환경이 불쾌하다(소음, 진동, 조명, 온도, 환기 등)",
                    "작업공간이 비좁고 불편하다",
                    "작업환경이 안전하지 않다",
                    "일이 매우 빨리 처리되어야 한다",
                    "일의 양이 너무 많다",
                    "시간내에 업무를 끝내기가 어렵다",
                    "업무수행 중에 고도의 집중이 요구된다",
                    "하고 있는 일의 방식을 결정할 수 있다",
                    "업무수행 과정에서 나의 개인적 의견이 반영된다",
                    "업무량과 작업스케줄을 스스로 조절할 수 있다",
                    "직장동료들과의 의사소통이 원활하지 않다",
                    "직장동료들 간의 갈등이 있다",
                    "직장동료들이 도움이 되지 않는다",
                    "고용이 불안정하다",
                    "앞으로 2년 동안 지금 직장에서 일할 수 있을지 확신하기 어렵다",
                    "회사의 정책결정에 영향력이 없다",
                    "회사의 정책이나 전략에 대한 정보가 부족하다",
                    "내 업무가 회사에 미치는 영향에 대한 정보가 부족하다",
                    "회사에서 나에게 기대하는 것이 무엇인지 알기 어렵다",
                    "업무분야에서 개인의 발전가능성이 없다",
                    "나의 교육이나 기술 수준에 비해 내가 하고 있는 일이 가치가 낮다",
                    "나의 직업은 내가 가진 능력에 비해 보수가 적다",
                    "직장에서 남녀차별이 있다",
                    "비합리적이고 이해되지 않는 업무지시를 받는다",
                    "업무량에 비해 인력이 부족하다",
                    "업무 수행에 필요한 장비나 시설이 부족하다"
                ],
                options: [
                    "전혀 그렇지 않다",
                    "그렇지 않다",
                    "그렇다",
                    "매우 그렇다"
                ]
            }
        };

        // 현재 상태
        let currentTest = 'phq9';
        let currentQuestion = 0;
        let responses = {
            phq9: [],
            gad7: [],
            koss: []
        };

        // 검사 시작
        function startAssessment() {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('assessment-screen').style.display = 'block';
            loadQuestion();
        }

        // 질문 로드
        function loadQuestion() {
            const testData = assessmentData[currentTest];
            const totalQuestions = testData.questions.length;
            
            // 헤더 업데이트
            document.getElementById('current-test-title').textContent = testData.title;
            document.getElementById('current-test-subtitle').textContent = testData.subtitle;
            document.getElementById('test-badge').textContent = testData.badge;
            
            // 진행률 업데이트
            const overallProgress = calculateOverallProgress();
            document.getElementById('progress-fill').style.width = `${overallProgress}%`;
            
            // 질문 번호 및 텍스트
            document.getElementById('question-number').textContent = `질문 ${currentQuestion + 1} / ${totalQuestions}`;
            document.getElementById('question-text').textContent = testData.questions[currentQuestion];
            
            // 선택지 생성
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            testData.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.onclick = () => selectOption(index);
                
                optionElement.innerHTML = `
                    <div class="option-radio"></div>
                    <div class="option-text">${option}</div>
                `;
                
                optionsContainer.appendChild(optionElement);
            });
            
            // 네비게이션 버튼 상태
            updateNavigationButtons();
        }

        // 선택지 선택
        function selectOption(optionIndex) {
            // 기존 선택 제거
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // 새 선택 추가
            document.querySelectorAll('.option')[optionIndex].classList.add('selected');
            
            // 응답 저장
            responses[currentTest][currentQuestion] = optionIndex;
            
            // 다음 버튼 활성화
            document.getElementById('next-btn').disabled = false;
        }

        // 전체 진행률 계산
        function calculateOverallProgress() {
            const totalQuestions = 9 + 7 + 26; // PHQ-9 + GAD-7 + KOSS
            let completedQuestions = 0;
            
            if (currentTest === 'phq9') {
                completedQuestions = currentQuestion;
            } else if (currentTest === 'gad7') {
                completedQuestions = 9 + currentQuestion;
            } else if (currentTest === 'koss') {
                completedQuestions = 16 + currentQuestion;
            }
            
            return Math.round((completedQuestions / totalQuestions) * 100);
        }

        // 네비게이션 버튼 상태 업데이트
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            // 이전 버튼
            if (currentTest === 'phq9' && currentQuestion === 0) {
                prevBtn.disabled = true;
            } else {
                prevBtn.disabled = false;
            }
            
            // 다음 버튼
            const hasResponse = responses[currentTest][currentQuestion] !== undefined;
            nextBtn.disabled = !hasResponse;
            
            // 마지막 질문인지 확인
            const testData = assessmentData[currentTest];
            const isLastQuestion = currentQuestion === testData.questions.length - 1;
            const isLastTest = currentTest === 'koss';
            
            if (isLastQuestion && isLastTest) {
                nextBtn.textContent = '결과 보기';
            } else {
                nextBtn.textContent = '다음';
            }
        }

        // 다음 질문
        function nextQuestion() {
            const testData = assessmentData[currentTest];
            const isLastQuestion = currentQuestion === testData.questions.length - 1;
            
            if (isLastQuestion) {
                // 다음 테스트로 이동
                if (currentTest === 'phq9') {
                    currentTest = 'gad7';
                    currentQuestion = 0;
                    loadQuestion();
                } else if (currentTest === 'gad7') {
                    currentTest = 'koss';
                    currentQuestion = 0;
                    loadQuestion();
                } else {
                    // 모든 테스트 완료 - 결과 화면으로
                    showResults();
                }
            } else {
                currentQuestion++;
                loadQuestion();
            }
        }

        // 이전 질문
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            } else {
                // 이전 테스트로 이동
                if (currentTest === 'gad7') {
                    currentTest = 'phq9';
                    currentQuestion = assessmentData.phq9.questions.length - 1;
                    loadQuestion();
                } else if (currentTest === 'koss') {
                    currentTest = 'gad7';
                    currentQuestion = assessmentData.gad7.questions.length - 1;
                    loadQuestion();
                }
            }
        }

        // 결과 계산 및 표시
        function showResults() {
            // 점수 계산
            const phq9Score = calculatePHQ9Score();
            const gad7Score = calculateGAD7Score();
            const kossScore = calculateKOSSScore();
            
            // 결과 해석
            const phq9Result = interpretPHQ9(phq9Score);
            const gad7Result = interpretGAD7(gad7Score);
            const kossResult = interpretKOSS(kossScore);
            
            // 화면 전환
            document.getElementById('assessment-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'block';
            
            // 상태 카드 업데이트
            updateStatusCards(phq9Score, gad7Score, kossScore, phq9Result, gad7Result, kossResult);
            
            // 상세 결과 업데이트
            updateDetailedResults(phq9Score, gad7Score, kossScore, phq9Result, gad7Result, kossResult);
            
            // 분석 및 권장사항 생성
            generateAnalysisAndRecommendations(phq9Result, gad7Result, kossResult);
            
            // 타임스탬프 설정
            setTimestamp();
        }

        // PHQ-9 점수 계산
        function calculatePHQ9Score() {
            return responses.phq9.reduce((sum, score) => sum + score, 0);
        }

        // GAD-7 점수 계산
        function calculateGAD7Score() {
            return responses.gad7.reduce((sum, score) => sum + score, 0);
        }

        // KOSS 점수 계산
        function calculateKOSSScore() {
            // KOSS는 실제로는 영역별로 계산되지만, 여기서는 단순화하여 전체 평균을 구함
            const totalScore = responses.koss.reduce((sum, score) => sum + score, 0);
            const averageScore = totalScore / responses.koss.length;
            return Math.round((averageScore - 1) * 100 / 3 * 10) / 10;
        }

        // PHQ-9 결과 해석
        function interpretPHQ9(score) {
            if (score <= 4) return { level: 'normal', text: '우울증 아님', className: 'status-normal' };
            if (score <= 9) return { level: 'mild', text: '가벼운 우울', className: 'status-mild' };
            if (score <= 19) return { level: 'moderate', text: '중간 우울', className: 'status-moderate' };
            return { level: 'severe', text: '심한 우울', className: 'status-severe' };
        }

        // GAD-7 결과 해석
        function interpretGAD7(score) {
            if (score <= 4) return { level: 'normal', text: '불안 아님', className: 'status-normal' };
            if (score <= 9) return { level: 'mild', text: '가벼운 불안', className: 'status-mild' };
            if (score <= 14) return { level: 'moderate', text: '중간 불안', className: 'status-moderate' };
            return { level: 'severe', text: '심한 불안', className: 'status-severe' };
        }

        // KOSS 결과 해석
        function interpretKOSS(score) {
            if (score <= 42.4) return { level: 'normal', text: '정상', className: 'status-normal' };
            if (score <= 48.4) return { level: 'boundary', text: '경계 수준', className: 'status-mild' };
            if (score <= 54.7) return { level: 'risk', text: '위험', className: 'status-moderate' };
            return { level: 'high-risk', text: '고위험', className: 'status-severe' };
        }

        // 상태 카드 업데이트
        function updateStatusCards(phq9Score, gad7Score, kossScore, phq9Result, gad7Result, kossResult) {
            // PHQ-9
            const phq9Icon = document.getElementById('phq9-icon');
            phq9Icon.textContent = phq9Score;
            phq9Icon.className = `status-icon ${phq9Result.className}`;
            document.getElementById('phq9-status').textContent = phq9Result.text;
            
            // GAD-7
            const gad7Icon = document.getElementById('gad7-icon');
            gad7Icon.textContent = gad7Score;
            gad7Icon.className = `status-icon ${gad7Result.className}`;
            document.getElementById('gad7-status').textContent = gad7Result.text;
            
            // KOSS
            const kossIcon = document.getElementById('koss-icon');
            kossIcon.textContent = kossScore;
            kossIcon.className = `status-icon ${kossResult.className}`;
            document.getElementById('koss-status').textContent = kossResult.text;
        }

        // 상세 결과 업데이트
        function updateDetailedResults(phq9Score, gad7Score, kossScore, phq9Result, gad7Result, kossResult) {
            document.getElementById('phq9-score').textContent = `${phq9Score}점`;
            document.getElementById('phq9-result-status').textContent = phq9Result.text;
            document.getElementById('phq9-result-status').className = `result-status ${phq9Result.className}`;
            
            document.getElementById('gad7-score').textContent = `${gad7Score}점`;
            document.getElementById('gad7-result-status').textContent = gad7Result.text;
            document.getElementById('gad7-result-status').className = `result-status ${gad7Result.className}`;
            
            document.getElementById('koss-score').textContent = `${kossScore}점`;
            document.getElementById('koss-result-status').textContent = kossResult.text;
            document.getElementById('koss-result-status').className = `result-status ${kossResult.className}`;
        }

        // 분석 및 권장사항 생성
        function generateAnalysisAndRecommendations(phq9Result, gad7Result, kossResult) {
            const analysisContent = document.getElementById('analysis-content');
            const immediateRecs = document.getElementById('immediate-recommendations');
            const professionalRecs = document.getElementById('professional-recommendations');
            
            // 전체 위험도 평가
            const riskLevels = [phq9Result.level, gad7Result.level, kossResult.level];
            const hasModerateOrSevere = riskLevels.includes('moderate') || riskLevels.includes('severe') || riskLevels.includes('high-risk');
            const hasMild = riskLevels.includes('mild') || riskLevels.includes('boundary');
            
            // 분석 내용 생성
            let analysisHTML = '';
            
            if (hasModerateOrSevere) {
                analysisHTML = `
                    <div class="alert">
                        <div class="alert-title">주의 필요</div>
                        현재 ${gad7Result.text} 상태와 ${phq9Result.text} 증상이 관찰되며, 직무스트레스가 ${kossResult.text}에 있습니다. 조기 개입을 통해 증상 악화를 방지하는 것이 중요합니다.
                    </div>
                `;
            } else if (hasMild) {
                analysisHTML = `
                    <div style="background: #fef3c7; border: 1px solid #fbbf24; color: #92400e; padding: 16px; border-radius: 12px;">
                        <div style="font-weight: 600; margin-bottom: 8px;">경미한 주의 필요</div>
                        현재 일부 영역에서 경미한 스트레스나 우울/불안 증상이 관찰됩니다. 적절한 자기관리를 통해 개선할 수 있습니다.
                    </div>
                `;
            } else {
                analysisHTML = `
                    <div style="background: #d1fae5; border: 1px solid #10b981; color: #047857; padding: 16px; border-radius: 12px;">
                        <div style="font-weight: 600; margin-bottom: 8px;">양호한 상태</div>
                        현재 정신건강 상태가 전반적으로 양호합니다. 현재의 건강한 생활 패턴을 유지하시기 바랍니다.
                    </div>
                `;
            }
            
            analysisContent.innerHTML = analysisHTML;
            
            // 즉시 실행 가능한 관리법
            let immediateRecsHTML = '';
            if (hasModerateOrSevere) {
                immediateRecsHTML = `
                    <div class="recommendation-item">규칙적인 수면 패턴 유지 (7-8시간)</div>
                    <div class="recommendation-item">점심시간 10분 산책 또는 명상</div>
                    <div class="recommendation-item">업무 중 1시간마다 5분 휴식</div>
                    <div class="recommendation-item">걱정 일기 작성 (하루 5분)</div>
                    <div class="recommendation-item">스마트폰/TV 시청 시간 제한</div>
                `;
            } else if (hasMild) {
                immediateRecsHTML = `
                    <div class="recommendation-item">규칙적인 운동 (주 3회, 30분)</div>
                    <div class="recommendation-item">충분한 수면과 휴식</div>
                    <div class="recommendation-item">스트레스 해소 활동 찾기</div>
                    <div class="recommendation-item">가족, 친구와의 시간 늘리기</div>
                `;
            } else {
                immediateRecsHTML = `
                    <div class="recommendation-item">현재의 건강한 생활 패턴 유지</div>
                    <div class="recommendation-item">정기적인 자기점검 (월 1회)</div>
                    <div class="recommendation-item">취미 활동 지속하기</div>
                    <div class="recommendation-item">사회적 관계 유지하기</div>
                `;
            }
            immediateRecs.innerHTML = immediateRecsHTML;
            
            // 전문적 도움
            let professionalRecsHTML = '';
            if (hasModerateOrSevere) {
                professionalRecsHTML = `
                    <div class="recommendation-item">정신건강 전문의 상담 권장</div>
                    <div class="recommendation-item">EAP(직원지원프로그램) 상담 서비스 이용</div>
                    <div class="recommendation-item">스트레스 관리 교육 프로그램 참여</div>
                    <div class="recommendation-item">정기적인 정신건강 검진</div>
                `;
            } else if (hasMild) {
                professionalRecsHTML = `
                    <div class="recommendation-item">EAP(직원지원프로그램) 상담 고려</div>
                    <div class="recommendation-item">스트레스 관리 워크숍 참여</div>
                    <div class="recommendation-item">정신건강 관련 교육 자료 활용</div>
                `;
            } else {
                professionalRecsHTML = `
                    <div class="recommendation-item">연 1회 정신건강 검진</div>
                    <div class="recommendation-item">정신건강 교육 프로그램 참여</div>
                    <div class="recommendation-item">직장 내 동료 지원 프로그램 활용</div>
                `;
            }
            professionalRecs.innerHTML = professionalRecsHTML;
        }

        // 타임스탬프 설정
        function setTimestamp() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: 'numeric',
                minute: 'numeric'
            };
            const currentTime = now.toLocaleDateString('ko-KR', options);
            
            const nextMonth = new Date(now);
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            const nextTest = nextMonth.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' });
            
            document.getElementById('timestamp').innerHTML = `
                검사일시: ${currentTime}<br>
                다음 검사 권장일: ${nextTest}
            `;
        }

        // 검사 다시 시작
        function restartAssessment() {
            // 상태 초기화
            currentTest = 'phq9';
            currentQuestion = 0;
            responses = {
                phq9: [],
                gad7: [],
                koss: []
            };
            
            // 화면 전환
            document.getElementById('results-screen').style.display = 'none';
            document.getElementById('intro-screen').style.display = 'block';
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 초기 상태에서는 시작 화면만 표시
            document.getElementById('assessment-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'none';
        });
    </script>
</body>
</html>